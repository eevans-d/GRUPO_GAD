# ‚úèÔ∏è CORRECCIONES DETALLADAS: MANUAL GRUPO_GAD

**Documento complementario de:** ANALISIS_MANUAL_VS_PROYECTO_REAL.md  
**Prop√≥sito:** Proporcionar correcciones espec√≠ficas l√≠nea por l√≠nea del manual

---

## üìù PARTE 1: RESUMEN EJECUTIVO CORREGIDO

### ‚ùå VERSI√ìN ORIGINAL (INCORRECTA)

> GRUPO_GAD es un sistema ag√©ntico de inteligencia artificial dise√±ado para automatizar y optimizar procesos de gesti√≥n administrativa distrital, incluyendo an√°lisis de datos geogr√°ficos, gesti√≥n documental y servicios ciudadanos. El sistema integra capacidades de procesamiento de lenguaje natural, an√°lisis de datos PostgreSQL/PostGIS y automatizaci√≥n de flujos de trabajo administrativos a trav√©s de interfaces web interactivas.

### ‚úÖ VERSI√ìN CORREGIDA

> **GRUPO_GAD** es un sistema de gesti√≥n de tareas operacionales dise√±ado para coordinar y supervisar operaciones de seguridad y vigilancia. El sistema combina una API REST FastAPI, un bot de Telegram para personal operativo y un dashboard de monitoreo en tiempo real. Gestiona tareas de patrullaje, investigaci√≥n, vigilancia e intervenci√≥n, con seguimiento geoespacial mediante PostgreSQL+PostGIS, cach√© Redis y notificaciones en tiempo real v√≠a WebSockets.

---

## üìù PARTE 2: ESPECIFICACIONES DEL PROYECTO CORREGIDAS

### ‚ùå DESCRIPCI√ìN BREVE ORIGINAL

> Sistema ag√©ntico IA que automatiza procesos administrativos distritales mediante an√°lisis de datos espaciales, gesti√≥n documental inteligente y atenci√≥n automatizada de servicios ciudadanos.

### ‚úÖ DESCRIPCI√ìN BREVE CORREGIDA

> Sistema backend para gesti√≥n de tareas operacionales de seguridad, con API REST, Bot de Telegram y dashboard geoespacial. Coordina efectivos en campo, registra actividades y genera m√©tricas de rendimiento operacional.

---

## üìù PARTE 3: CAPACIDADES PRINCIPALES CORREGIDAS

### **CAPACIDAD 1: GESTI√ìN GEOESPACIAL**

#### ‚ùå ORIGINAL
> **An√°lisis Geoespacial Inteligente** ‚Äî Procesa y analiza datos geogr√°ficos mediante PostGIS, generando insights autom√°ticos sobre territorios, zonas y distribuci√≥n de servicios distritales.

#### ‚úÖ CORREGIDA
> **Registro y Visualizaci√≥n Geoespacial** ‚Äî Almacena coordenadas geogr√°ficas (lat/lon) de tareas operacionales y las visualiza en un dashboard con mapa interactivo. Permite filtrar tareas por radio de distancia desde un punto central para optimizar asignaciones.

---

### **CAPACIDAD 2: GESTI√ìN DOCUMENTAL**

#### ‚ùå ORIGINAL
> **Gesti√≥n Documental Automatizada** ‚Äî Clasifica, indexa y recupera documentos administrativos mediante procesamiento de lenguaje natural y extracci√≥n de entidades.

#### ‚úÖ ELIMINAR COMPLETAMENTE
Esta funcionalidad **NO existe** en el proyecto. Eliminar toda la secci√≥n.

---

### **CAPACIDAD 3: GESTI√ìN DE TAREAS**

#### ‚ùå ORIGINAL
> **Atenci√≥n Ciudadana Conversacional** ‚Äî Responde consultas sobre tr√°mites, servicios y normativas distritales mediante interfaz conversacional natural.

#### ‚úÖ CORREGIDA
> **Gesti√≥n de Tareas Operacionales v√≠a Bot** ‚Äî Bot de Telegram que permite al personal operativo:
> - Crear tareas (patrullaje, investigaci√≥n, vigilancia, intervenci√≥n)
> - Consultar historial de tareas asignadas
> - Finalizar tareas con reporte de resultados
> - Recibir notificaciones push de nuevas asignaciones
> - Visualizar estad√≠sticas personales (productividad, tiempos)

---

### **CAPACIDAD 4: SEGUIMIENTO Y AUDITOR√çA**

#### ‚ùå ORIGINAL
> **Automatizaci√≥n de Flujos Administrativos** ‚Äî Ejecuta procesos predefinidos (validaciones, aprobaciones, notificaciones) reduciendo intervenci√≥n manual.

#### ‚úÖ CORREGIDA
> **Seguimiento Autom√°tico de Tareas** ‚Äî El sistema registra autom√°ticamente:
> - Historial completo de cambios de estado (PROGRAMMED ‚Üí IN_PROGRESS ‚Üí COMPLETED)
> - Usuario responsable de cada cambio
> - Timestamp preciso de cada transici√≥n
> - Motivos de cambios de estado
> - Notificaciones en tiempo real v√≠a WebSocket y Telegram

---

### **CAPACIDAD 5: M√âTRICAS OPERACIONALES**

#### ‚ùå ORIGINAL
> **Generaci√≥n de Reportes Inteligentes** ‚Äî Crea reportes autom√°ticos con an√°lisis estad√≠stico y visualizaciones basadas en datos operativos.

#### ‚úÖ CORREGIDA
> **Estad√≠sticas Operacionales con Cach√©** ‚Äî Endpoints API que devuelven m√©tricas agregadas:
> - Total de tareas por usuario (completadas, en progreso, canceladas)
> - Duraci√≥n promedio de tareas por tipo y prioridad
> - Tasa de √©xito (completadas vs. totales)
> - Productividad diaria (tareas/d√≠a)
> - Percentiles de duraci√≥n (p25, p50, p75)
> - Cach√© Redis (TTL 5 min) para optimizar consultas frecuentes

---

### **CAPACIDAD 6: INTEGRACIONES**

#### ‚ùå ORIGINAL
> **Integraci√≥n Multi-Sistema** ‚Äî Conecta bases de datos legacy, APIs externas y sistemas de gesti√≥n municipal existentes.

#### ‚úÖ CORREGIDA
> **Integraci√≥n Telegram** ‚Äî El sistema se integra con Telegram Bot API para notificaciones push al personal operativo. Arquitectura interna con comunicaci√≥n API ‚Üî Bot ‚Üî WebSocket para sincronizaci√≥n en tiempo real.

---

## üìù PARTE 4: INTEGRACIONES CORREGIDAS

### **CANALES**

#### ‚ùå ORIGINAL
- Interfaz web HTML/JavaScript (aplicaci√≥n principal)
- Shell scripts para automatizaci√≥n de tareas administrativas
- API REST para integraciones externas

#### ‚úÖ CORREGIDO
- **API REST FastAPI** (puerto 8000): `/api/v1/*` endpoints para gesti√≥n de usuarios, tareas, estad√≠sticas
- **Bot de Telegram**: Interfaz principal para personal operativo en campo
- **WebSockets** (`/ws/connect`): Comunicaci√≥n en tiempo real para notificaciones y actualizaciones de estado
- **Dashboard web simple** (`/dashboard`): Visualizaci√≥n de mapa con tareas y efectivos
- **Reverse Proxy Caddy**: Puerto 80/443 para acceso HTTPS

---

### **BASES DE DATOS Y ALMACENAMIENTO**

#### ‚ùå ORIGINAL
- PostgreSQL con extensi√≥n PostGIS (datos espaciales)
- Sistema de archivos para documentos y logs
- Makefiles para gesti√≥n de configuraciones

#### ‚úÖ CORREGIDO
- **PostgreSQL 15 + PostGIS 3.4** (puerto 5434): Base de datos principal con soporte geoespacial
- **Redis 7.2** (puerto 6381):
  - Cach√© de consultas frecuentes (CacheService)
  - Pub/Sub para broadcast de WebSocket cross-workers
  - Stats de endpoints
- **Logs estructurados**: Archivos `.log` gestionados por Loguru con rotaci√≥n autom√°tica
- **Makefile**: Solo para desarrollo (comandos: `make up`, `make down`, `make migrate`, `make test`)

---

### **SISTEMAS EXTERNOS**

#### ‚ùå ORIGINAL
- APIs de servicios municipales
- Sistemas de gesti√≥n documental legacy
- Plataformas de notificaciones ciudadanas

#### ‚úÖ CORREGIDO
- **Telegram Bot API**: √önica integraci√≥n externa para env√≠o/recepci√≥n de mensajes
- **Sistema autocontenido**: No hay integraciones con sistemas legacy o externos adicionales

---

## üìù PARTE 5: CARACTER√çSTICAS DE COMPORTAMIENTO CORREGIDAS

### **TIEMPOS DE RESPUESTA**

#### ‚ùå ORIGINAL
- Consultas simples: < 2 segundos
- An√°lisis geoespacial: < 5 segundos
- Generaci√≥n de reportes: < 10 segundos

#### ‚úÖ CORREGIDO
- **Endpoints API sin cach√©**: 50-200 ms (consultas a DB)
- **Endpoints con cach√© Redis**: 5-10 ms (hit rate >80%)
- **Consultas geoespaciales** (`/geo/map/view`): 100-300 ms dependiendo del radio
- **WebSocket latency**: < 50 ms para mensajes broadcast
- **Smoke test objetivo**: 16/16 checks en < 30 segundos

---

### **TONO DE COMUNICACI√ìN**

#### ‚ùå ORIGINAL
> Formal-profesional con claridad ciudadana, lenguaje administrativo accesible, emp√°tico en atenci√≥n a usuarios.

#### ‚úÖ CORREGIDO
> **Bot de Telegram:** Tono directo y operativo, uso de emojis para claridad visual (üö® emergencias, ‚úÖ completado, ‚ö†Ô∏è advertencias). Mensajes concisos optimizados para lectura en m√≥vil en situaciones de campo.

---

### **REGISTROS QUE MANTIENE**

#### ‚ùå ORIGINAL
- Logs de interacciones en PostgreSQL (timestamp, usuario, acci√≥n, resultado)
- Historial de consultas y respuestas en base de datos
- Auditor√≠a de cambios en documentos (qui√©n, cu√°ndo, qu√©)
- M√©tricas de rendimiento en tablas de monitoreo

#### ‚úÖ CORREGIDO
- **Historial de estados de tareas** (tabla `historial_estados`):
  - Cada cambio de estado (PROGRAMMED ‚Üí IN_PROGRESS ‚Üí COMPLETED)
  - Usuario responsable, timestamp, motivo
- **M√©tricas agregadas** (tabla `metricas_tareas`):
  - Por tipo de tarea y prioridad
  - Total tareas, horas, promedios, percentiles, tasa de √©xito
- **Logs estructurados de aplicaci√≥n** (Loguru):
  - Nivel INFO/WARNING/ERROR con contexto JSON
  - Rotaci√≥n: 10 MB por archivo, 7 d√≠as de retenci√≥n
- **M√©tricas Prometheus** (endpoint `/metrics`):
  - Request count, latencies, error rates
  - M√©tricas de sistema (CPU, memoria, disco)

---

## üìù PARTE 6: DATOS QUE REGISTRA - CORRECCIONES

### **ELIMINAR TABLAS FICTICIAS**

#### ‚ùå Tabla documentada: `interacciones_log`
**NO EXISTE.** Eliminar completamente del manual.

#### ‚ùå Tabla documentada: `documentos_procesados`
**NO EXISTE.** Eliminar completamente del manual.

---

### **DOCUMENTAR TABLAS REALES**

#### ‚úÖ **Tabla 1: `usuarios`**

```sql
CREATE TABLE usuarios (
    id INTEGER PRIMARY KEY,
    uuid UUID UNIQUE NOT NULL,
    dni VARCHAR(20) UNIQUE NOT NULL,
    nombre VARCHAR(100) NOT NULL,
    apellido VARCHAR(100) NOT NULL,
    email VARCHAR UNIQUE NOT NULL,
    telefono VARCHAR(20),
    telegram_id BIGINT UNIQUE,  -- ID de Telegram para notificaciones
    nivel ENUM('LEVEL_1', 'LEVEL_2', 'LEVEL_3') NOT NULL,  -- Jerarqu√≠a operacional
    hashed_password VARCHAR(255) NOT NULL,
    verificado BOOLEAN DEFAULT FALSE NOT NULL,
    ultimo_acceso TIMESTAMP WITH TIME ZONE,
    intentos_fallidos INTEGER DEFAULT 0 NOT NULL,
    bloqueado_hasta TIMESTAMP WITH TIME ZONE,  -- Bloqueo por intentos fallidos
    extra_data JSONB DEFAULT '{}' NOT NULL,
    created_at TIMESTAMP NOT NULL,
    updated_at TIMESTAMP NOT NULL,
    deleted_at TIMESTAMP  -- Soft delete
);
```

**Descripci√≥n:**
- Usuario del sistema (personal operativo: coordinadores y efectivos)
- Niveles jer√°rquicos: LEVEL_1 (supervisor), LEVEL_2 (coordinador), LEVEL_3 (efectivo)
- Vinculaci√≥n con Telegram mediante `telegram_id`
- Seguridad: control de intentos fallidos y bloqueo temporal

---

#### ‚úÖ **Tabla 2: `efectivos`**

```sql
CREATE TABLE efectivos (
    id INTEGER PRIMARY KEY,
    uuid UUID UNIQUE NOT NULL,
    usuario_id INTEGER UNIQUE NOT NULL REFERENCES usuarios(id),
    codigo_interno VARCHAR(50) UNIQUE NOT NULL,  -- Ej: "EF-001"
    rango VARCHAR(50),  -- Ej: "Oficial", "Cabo", "Sargento"
    unidad VARCHAR(100),  -- Ej: "Unidad Norte"
    especialidad VARCHAR(100),  -- Ej: "K9", "Tr√°nsito", "Investigaci√≥n"
    estado_disponibilidad ENUM('DISPONIBLE', 'EN_TAREA', 'FUERA_SERVICIO', 'NO_DISPONIBLE') NOT NULL,
    ultima_actualizacion_estado TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP NOT NULL,
    metadata JSONB,
    geom GEOMETRY(POINT, 4326),  -- Ubicaci√≥n actual (PostGIS) - agregado en migraci√≥n posterior
    created_at TIMESTAMP NOT NULL,
    updated_at TIMESTAMP NOT NULL,
    deleted_at TIMESTAMP
);

CREATE INDEX ix_efectivos_codigo_interno ON efectivos(codigo_interno);
CREATE INDEX ix_efectivos_estado_disponibilidad ON efectivos(estado_disponibilidad);
CREATE INDEX ix_efectivos_uuid ON efectivos(uuid);
```

**Descripci√≥n:**
- Extiende tabla `usuarios` con informaci√≥n operacional espec√≠fica
- Estado de disponibilidad actualizado en tiempo real
- Geolocalizaci√≥n con PostGIS para tracking en mapa
- Relaci√≥n 1:1 con usuario

---

#### ‚úÖ **Tabla 3: `tareas`**

```sql
CREATE TABLE tareas (
    id INTEGER PRIMARY KEY,
    uuid UUID UNIQUE NOT NULL,
    codigo VARCHAR(50) UNIQUE NOT NULL,  -- Ej: "TASK-2025-00123"
    titulo VARCHAR(200) NOT NULL,
    descripcion TEXT,
    
    -- Clasificaci√≥n
    tipo ENUM('PATRULLAJE', 'INVESTIGACION', 'VIGILANCIA', 'INTERVENCION', 
              'ADMINISTRATIVA', 'ENTRENAMIENTO') NOT NULL,
    prioridad ENUM('LOW', 'MEDIUM', 'HIGH', 'URGENT', 'CRITICAL') NOT NULL DEFAULT 'MEDIUM',
    
    -- Fechas programadas vs reales
    inicio_programado TIMESTAMP WITH TIME ZONE NOT NULL,
    fin_programado TIMESTAMP WITH TIME ZONE,
    inicio_real TIMESTAMP WITH TIME ZONE,
    fin_real TIMESTAMP WITH TIME ZONE,
    tiempo_pausado INTERVAL,  -- Tiempo acumulado en pausa
    pausado_en TIMESTAMP WITH TIME ZONE,
    
    -- Estado de la tarea
    estado ENUM('PROGRAMMED', 'IN_PROGRESS', 'COMPLETED', 'CANCELLED', 'PAUSED') 
           NOT NULL DEFAULT 'PROGRAMMED',
    
    -- Asignaci√≥n
    delegado_usuario_id INTEGER NOT NULL REFERENCES usuarios(id),  -- Responsable principal
    creado_por_usuario_id INTEGER NOT NULL REFERENCES usuarios(id),  -- Qui√©n cre√≥
    
    -- Ubicaci√≥n geogr√°fica
    ubicacion_lat NUMERIC(10, 8),
    ubicacion_lon NUMERIC(11, 8),
    ubicacion_descripcion TEXT,  -- Ej: "Av. San Mart√≠n 500, esquina Belgrano"
    
    -- Efectivos asignados (array de IDs)
    efectivos_asignados INTEGER[] DEFAULT '{}' NOT NULL,
    
    -- M√©tricas
    duracion_real_horas NUMERIC,  -- Calculado al finalizar
    
    -- Datos adicionales
    notas JSONB DEFAULT '{}' NOT NULL,  -- Anotaciones durante ejecuci√≥n
    extra_data JSONB DEFAULT '{}' NOT NULL,  -- Datos extensibles
    
    created_at TIMESTAMP NOT NULL,
    updated_at TIMESTAMP NOT NULL,
    deleted_at TIMESTAMP,
    
    -- Constraints
    CONSTRAINT chk_tareas_fechas 
        CHECK (fin_programado IS NULL OR fin_programado > inicio_programado),
    CONSTRAINT chk_tareas_fechas_reales 
        CHECK ((inicio_real IS NULL AND fin_real IS NULL) OR 
               (inicio_real IS NOT NULL AND fin_real IS NULL) OR 
               (inicio_real IS NOT NULL AND fin_real IS NOT NULL AND fin_real >= inicio_real))
);

-- √çndices de performance (agregados en migraci√≥n 094f640cda5e)
CREATE INDEX idx_tareas_delegado_estado_created 
    ON tareas(delegado_usuario_id, estado, created_at DESC);
CREATE INDEX idx_tareas_active 
    ON tareas(id, estado) WHERE deleted_at IS NULL;
CREATE INDEX idx_tareas_created_at 
    ON tareas(created_at DESC);
CREATE INDEX idx_tareas_estado 
    ON tareas(estado);
```

**Descripci√≥n:**
- N√∫cleo del sistema: registra todas las tareas operacionales
- Tipos espec√≠ficos de operaciones de seguridad
- Prioridades de CRITICAL (emergencias) a LOW (administrativas)
- Seguimiento completo de tiempos programados vs reales
- Soporte para pausas (efectivo debe atender otra urgencia)
- Relaci√≥n many-to-many con efectivos v√≠a tabla `tarea_efectivos`
- √çndices optimizados para consultas frecuentes (usuario + estado)

---

#### ‚úÖ **Tabla 4: `historial_estados`**

```sql
CREATE TABLE historial_estados (
    id INTEGER PRIMARY KEY,
    tarea_id INTEGER NOT NULL REFERENCES tareas(id),
    estado_anterior ENUM('PROGRAMMED', 'IN_PROGRESS', 'COMPLETED', 'CANCELLED', 'PAUSED'),
    estado_nuevo ENUM('PROGRAMMED', 'IN_PROGRESS', 'COMPLETED', 'CANCELLED', 'PAUSED') NOT NULL,
    usuario_id INTEGER REFERENCES usuarios(id),  -- Qui√©n hizo el cambio
    motivo TEXT,  -- Ej: "Completado sin incidentes", "Cancelado por orden superior"
    extra_data JSONB DEFAULT '{}' NOT NULL,
    created_at TIMESTAMP NOT NULL,
    updated_at TIMESTAMP NOT NULL,
    deleted_at TIMESTAMP
);
```

**Descripci√≥n:**
- Auditor√≠a completa de cambios de estado
- Rastreable: qui√©n cambi√≥, cu√°ndo, por qu√©
- Inmutable: solo inserts, no updates (log append-only)

---

#### ‚úÖ **Tabla 5: `tarea_efectivos`** (Asociaci√≥n many-to-many)

```sql
CREATE TABLE tarea_efectivos (
    tarea_id INTEGER NOT NULL REFERENCES tareas(id),
    efectivo_id INTEGER NOT NULL REFERENCES efectivos(id),
    PRIMARY KEY (tarea_id, efectivo_id)
);
```

**Descripci√≥n:**
- Permite asignar m√∫ltiples efectivos a una tarea (patrullajes, operativos)
- Complementa el campo `efectivos_asignados` en tareas (redundancia intencional para performance)

---

#### ‚úÖ **Tabla 6: `metricas_tareas`**

```sql
CREATE TABLE metricas_tareas (
    id INTEGER PRIMARY KEY,
    tipo_tarea ENUM('PATRULLAJE', 'INVESTIGACION', 'VIGILANCIA', 'INTERVENCION', 
                    'ADMINISTRATIVA', 'ENTRENAMIENTO') NOT NULL,
    prioridad ENUM('LOW', 'MEDIUM', 'HIGH', 'URGENT', 'CRITICAL') NOT NULL,
    
    -- M√©tricas agregadas
    total_tareas INTEGER NOT NULL,
    total_horas REAL NOT NULL,
    tiempo_promedio_horas REAL,
    tasa_exito DECIMAL(5,2),  -- % completadas
    
    -- Percentiles de duraci√≥n
    duracion_p25 REAL,
    duracion_p50 REAL,  -- Mediana
    duracion_p75 REAL,
    duracion_min REAL,
    duracion_max REAL,
    
    ultima_actualizacion TIMESTAMP NOT NULL,
    created_at TIMESTAMP NOT NULL,
    updated_at TIMESTAMP NOT NULL,
    deleted_at TIMESTAMP
);
```

**Descripci√≥n:**
- M√©tricas pre-agregadas para dashboards
- Actualizaci√≥n peri√≥dica (job nocturno o trigger)
- Consulta r√°pida sin agregaciones en tiempo real

---

## üìù PARTE 7: DASHBOARD REAL

### ‚ùå DESCRIPCI√ìN ORIGINAL (FICTICIA)

El manual describe un dashboard complejo con:
- URL: `https://gad-admin.dominio.gob/dashboard`
- KPIs: Volumen de Interacciones, Tasa de √âxito, Tiempo Medio Respuesta, % Escalado a Humano
- Gr√°ficos: L√≠neas temporales, barras horizontales, donut charts
- Tabla de "√öltimas Interacciones" con intents detectados
- 4 roles: Administrador General, Operador de Soporte, Analista de Datos, Auditor

### ‚úÖ REALIDAD

**Dashboard Simple Actual:**
- **URL:** `http://localhost:8000/dashboard` (o tras Caddy)
- **Contenido:**
  - Mapa interactivo (OpenStreetMap o similar)
  - Marcadores de tareas (color seg√∫n prioridad)
  - Posici√≥n de efectivos disponibles (si tienen geolocalizaci√≥n)
  - Panel lateral con lista de tareas activas
  - Filtros b√°sicos: tipo de tarea, estado, prioridad
- **NO tiene:**
  - Sistema de roles diferenciados
  - KPIs complejos como "tasa de √©xito de chatbot"
  - Gr√°ficos estad√≠sticos avanzados
  - Tabla de "interacciones" (porque no es un chatbot)

**Evidencia:**
```python
# src/api/routers/dashboard.py
@router.get("/dashboard", include_in_schema=False)
async def dashboard(request: Request):
    return templates.TemplateResponse("dashboard.html", {"request": request})
```

El template HTML es b√°sico y consume:
- `/api/v1/geo/map/view` para obtener tareas y efectivos
- WebSocket `/ws/connect` para actualizaciones en tiempo real

---

## üìù PARTE 8: EXPERIENCIA DE USUARIO REAL (BOT DE TELEGRAM)

### ‚ùå FLUJO ORIGINAL (FICTICIO)

El manual describe conversaciones ciudadano-chatbot:
```
Usuario: "Hola, quiero construir un garage en mi casa, ¬øqu√© permiso necesito?"
Agente: "Hola, entendido. Para construir un garage necesit√°s un permiso de obra menor..."
```

### ‚úÖ FLUJO REAL (BOT DE TELEGRAM PARA EFECTIVOS)

#### **Escenario 1: Crear Tarea de Patrullaje**

```
Efectivo: /crear_tarea

Bot: üìã *Crear Nueva Tarea*
     Selecciona el tipo:
     
     [üöî Patrullaje] [üîç Investigaci√≥n]
     [üëÅÔ∏è Vigilancia] [üö® Intervenci√≥n]
     [üìÑ Administrativa] [üéØ Entrenamiento]

Efectivo: [Toca "Patrullaje"]

Bot: Ingresa el t√≠tulo de la tarea:

Efectivo: Patrullaje Zona Centro

Bot: Ingresa la descripci√≥n (o /skip para omitir):

Efectivo: Recorrido rutinario por Av. San Mart√≠n y aleda√±as

Bot: Selecciona la prioridad:
     [üü¢ Baja] [üü° Media] [üü† Alta] [üî¥ Urgente] [‚ö´ Cr√≠tica]

Efectivo: [Toca "Media"]

Bot: ¬øDeseas agregar ubicaci√≥n?
     [üìç Enviar ubicaci√≥n] [‚è≠Ô∏è Omitir]

Efectivo: [Env√≠a ubicaci√≥n GPS: -31.4201, -64.1888]

Bot: ‚úÖ *Tarea Creada Exitosamente*
     
     üìå C√≥digo: TASK-2025-00456
     üöî Tipo: Patrullaje
     üìù T√≠tulo: Patrullaje Zona Centro
     üü° Prioridad: Media
     üìç Ubicaci√≥n: -31.4201, -64.1888
     üë§ Asignado a: Juan P√©rez (t√∫)
     
     [Ver en mapa] [Iniciar ahora]
```

---

#### **Escenario 2: Consultar Historial**

```
Efectivo: /historial

Bot: üìä *Tu Historial de Tareas*
     
     üü¢ *COMPLETADAS* (√öltimas 5)
     
     1Ô∏è‚É£ TASK-2025-00450
        Patrullaje Zona Norte
        ‚úÖ Completado 11/10/2025 18:30
        ‚è±Ô∏è Duraci√≥n: 2.5 horas
     
     2Ô∏è‚É£ TASK-2025-00443
        Vigilancia Plaza Central
        ‚úÖ Completado 11/10/2025 14:00
        ‚è±Ô∏è Duraci√≥n: 3 horas
     
     3Ô∏è‚É£ TASK-2025-00438
        Investigaci√≥n incidente Calle 9
        ‚úÖ Completado 10/10/2025 22:15
        ‚è±Ô∏è Duraci√≥n: 4.5 horas
     
     üîµ *EN PROGRESO* (1)
     
     1Ô∏è‚É£ TASK-2025-00456
        Patrullaje Zona Centro
        ‚ñ∂Ô∏è Iniciado hace 45 minutos
        [Finalizar] [Pausar]
     
     [‚Üê Anterior] [Siguiente ‚Üí] [Cerrar]
```

---

#### **Escenario 3: Finalizar Tarea**

```
Efectivo: [Toca "Finalizar" en tarea activa]

Bot: üìù *Finalizar Tarea TASK-2025-00456*
     
     Patrullaje Zona Centro
     Iniciado: 12/10/2025 14:00
     Duraci√≥n: 2 horas 15 minutos
     
     Ingresa un resumen de resultados:

Efectivo: Patrullaje completado sin incidentes. Se realiz√≥ control de velocidad en Av. San Mart√≠n. 3 infracciones leves registradas.

Bot: ‚úÖ *Tarea Finalizada*
     
     TASK-2025-00456 marcada como COMPLETADA
     Duraci√≥n final: 2h 15m
     
     üìà *Tus Estad√≠sticas Hoy*
     Total completadas: 3
     Tiempo total: 7h 45m
     Promedio: 2h 35m/tarea
     
     [Ver historial] [Nueva tarea] [Estad√≠sticas]
```

---

#### **Escenario 4: Notificaci√≥n de Asignaci√≥n**

```
[Notificaci√≥n push llega al efectivo]

Bot: üö® *Nueva Tarea Asignada*
     
     üìå TASK-2025-00458
     üî¥ URGENTE - Intervenci√≥n
     
     üìù T√≠tulo: Alarma activada en Banco Central
     üìç Ubicaci√≥n: Calle Rivadavia 234
     üë§ Creado por: Coord. Mart√≠nez
     ‚è∞ Inicio programado: INMEDIATO
     
     ‚ö†Ô∏è Esta tarea requiere respuesta urgente
     
     [Aceptar y comenzar] [Ver detalles]
```

---

## üìù PARTE 9: ENDPOINTS API REALES DOCUMENTADOS

### ‚úÖ **ESTRUCTURA COMPLETA DE ENDPOINTS**

```
BASE URL: http://localhost:8000/api/v1

‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
üîê AUTENTICACI√ìN
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ

POST   /auth/login
Request:
{
  "username": "juan.perez",
  "password": "password123"
}
Response:
{
  "access_token": "eyJhbGciOiJIUzI1NiIs...",
  "token_type": "bearer"
}

POST   /auth/logout
Headers: Authorization: Bearer {token}
Response: 200 OK

‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
üë§ USUARIOS
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ

GET    /users/
Query params: skip=0, limit=100
Response: Array<Usuario>

POST   /users/
Request:
{
  "dni": "12345678",
  "nombre": "Juan",
  "apellido": "P√©rez",
  "email": "juan@example.com",
  "password": "securepass",
  "nivel": "LEVEL_3",
  "telegram_id": 123456789
}

GET    /users/me
Response: Usuario actual autenticado

GET    /users/{user_id}
Response: Usuario espec√≠fico

PUT    /users/{user_id}
Request: Campos a actualizar

‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
üìã TAREAS
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ

GET    /tasks/
Query params:
  - estado: PROGRAMMED | IN_PROGRESS | COMPLETED | CANCELLED | PAUSED
  - tipo: PATRULLAJE | INVESTIGACION | VIGILANCIA | INTERVENCION | ADMINISTRATIVA | ENTRENAMIENTO
  - prioridad: LOW | MEDIUM | HIGH | URGENT | CRITICAL
  - delegado_usuario_id: int
  - skip: int (default 0)
  - limit: int (default 100)
Response: Array<Tarea>

POST   /tasks/
Request:
{
  "titulo": "Patrullaje Zona Centro",
  "descripcion": "Recorrido rutinario",
  "tipo": "PATRULLAJE",
  "prioridad": "MEDIUM",
  "inicio_programado": "2025-10-12T14:00:00Z",
  "delegado_usuario_id": 5,
  "ubicacion_lat": -31.4201,
  "ubicacion_lon": -64.1888
}

POST   /tasks/emergency
Request: Similar a POST /tasks/ pero con prioridad forzada a CRITICAL

GET    /tasks/{task_id}
Response: Tarea espec√≠fica con relaciones

PUT    /tasks/{task_id}
Request: Campos a actualizar (ej: cambio de estado, inicio_real, fin_real)

DELETE /tasks/{task_id}
Response: Tarea marcada como eliminada (soft delete)

‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
üó∫Ô∏è GEOLOCALIZACI√ìN
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ

GET    /geo/map/view
Query params:
  - center_lat: float (requerido)
  - center_lng: float (requerido)
  - radius_m: int (default 10000, max 100000)
Response:
{
  "tareas": [
    {
      "id": 123,
      "titulo": "Patrullaje...",
      "lat": -31.4201,
      "lon": -64.1888,
      "prioridad": "HIGH",
      "estado": "IN_PROGRESS"
    }
  ],
  "usuarios": []  // Vac√≠o si efectivos no tienen geolocalizaci√≥n
}

‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
üìä ESTAD√çSTICAS
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ

GET    /stats/user/{user_id}
Query params:
  - days: int (default 30)
  - use_cache: bool (default true)
Response:
{
  "usuario_id": 5,
  "periodo_dias": 30,
  "total_tareas": 45,
  "completadas": 42,
  "en_progreso": 2,
  "canceladas": 1,
  "promedio_duracion_horas": 2.5,
  "productividad_diaria": 1.5,
  "_cache": {
    "hit": true,
    "ttl_seconds": 300
  }
}

POST   /stats/invalidate/user/{user_id}
Response: Cach√© invalidada para ese usuario

‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
üíæ CACH√â (Admin)
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ

GET    /cache/stats
Response: Info de Redis (memoria, keys, hit rate, etc.)

POST   /cache/invalidate/{key}
Response: Key eliminada

POST   /cache/invalidate-pattern/{pattern:path}
Example: /cache/invalidate-pattern/stats:user:*
Response: Cantidad de keys eliminadas

POST   /cache/clear
‚ö†Ô∏è PELIGROSO: Limpia todo el cach√©

‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
üè• HEALTH & MONITORING
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ

GET    /health
Response: {"status": "ok"}

GET    /health/detailed
Response: Estado de DB, Redis, disco, memoria

GET    /health/ready
Response: Readiness probe (K8s)

GET    /health/live
Response: Liveness probe (K8s)

GET    /health/performance
Response: M√©tricas de rendimiento del sistema

GET    /health/government
Response: M√©tricas espec√≠ficas del dominio

GET    /metrics
Response: M√©tricas Prometheus (formato OpenMetrics)

‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
üîå WEBSOCKETS
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ

WS     /ws/connect
Headers: ?token={jwt_token} (query param)
Mensajes recibidos:
{
  "event_type": "CONNECTION_ACK" | "PING" | "NOTIFICATION" | "TASK_UPDATE",
  "data": {...},
  "timestamp": "2025-10-12T16:45:00Z"
}

GET    /ws/stats
Response:
{
  "total_messages_sent": 1234,
  "total_broadcasts": 56,
  "total_send_errors": 2,
  "last_broadcast_at": "2025-10-12T16:45:00Z",
  "connected_clients": 12
}

POST   /ws/_test/broadcast (solo dev/test)
Request: Mensaje a broadcast

‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
üìÑ DASHBOARD
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ

GET    /dashboard
Response: HTML template
```

---

## üìù PARTE 10: VARIABLES DE ENTORNO REALES

### ‚úÖ ARCHIVO `.env` COMPLETO

```bash
# ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
# POSTGRESQL
# ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
POSTGRES_USER=grupogad
POSTGRES_PASSWORD=your_secure_password_here
POSTGRES_DB=grupogad_db
POSTGRES_HOST=db  # Nombre del servicio Docker
POSTGRES_PORT=5432  # Puerto interno del contenedor

# URL completa (alternativa, tiene prioridad sobre variables individuales)
DATABASE_URL=postgresql+asyncpg://grupogad:your_secure_password_here@db:5432/grupogad_db

# ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
# REDIS
# ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
REDIS_HOST=redis  # Nombre del servicio Docker
REDIS_PORT=6379  # Puerto interno
REDIS_DB=0
REDIS_PASSWORD=  # Vac√≠o por defecto, configurar en producci√≥n

# ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
# JWT AUTHENTICATION
# ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
SECRET_KEY=generate_a_random_secret_key_with_at_least_32_chars
ALGORITHM=HS256
ACCESS_TOKEN_EXPIRE_MINUTES=60

# ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
# TELEGRAM BOT
# ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
TELEGRAM_BOT_TOKEN=1234567890:ABCdefGHIjklMNOpqrsTUVwxyz
TELEGRAM_API_URL=https://api.telegram.org  # Opcional, usar solo si hay proxy

# ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
# API CONFIGURATION
# ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
API_HOST=0.0.0.0
API_PORT=8000
API_TITLE=GRUPO GAD API
API_VERSION=1.0.0
API_PREFIX=/api/v1

# ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
# ENVIRONMENT
# ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
ENVIRONMENT=development  # development | production | test
LOG_LEVEL=INFO  # DEBUG | INFO | WARNING | ERROR

# ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
# CORS (solo desarrollo, ajustar en producci√≥n)
# ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
CORS_ORIGINS=http://localhost:3000,http://localhost:8000

# ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
# WEBSOCKET (opcional, usar solo en producci√≥n si JWT es obligatorio)
# ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
WS_REQUIRE_AUTH=false  # true en producci√≥n
```

---

## üéØ RESUMEN DE CORRECCIONES

### **Secciones a ELIMINAR completamente:**
1. ‚ùå Capacidad 2: Gesti√≥n Documental
2. ‚ùå Tabla `interacciones_log`
3. ‚ùå Tabla `documentos_procesados`
4. ‚ùå Todo el mockup de "Dashboard de Administrador" complejo
5. ‚ùå Ejemplos de conversaciones con ciudadanos
6. ‚ùå Referencias a "tr√°mites", "certificados", "permisos de construcci√≥n"
7. ‚ùå Integraci√≥n con "sistemas legacy" o "APIs municipales"

### **Secciones a REESCRIBIR completamente:**
1. ‚úÖ Resumen Ejecutivo
2. ‚úÖ Descripci√≥n breve del proyecto
3. ‚úÖ Todas las capacidades principales (1-6)
4. ‚úÖ Perspectiva de usuario (ciudadano ‚Üí efectivo)
5. ‚úÖ Estructura de mensajer√≠a (chatbot ‚Üí bot Telegram operativo)

### **Secciones a AGREGAR (no est√°n en el manual):**
1. ‚ûï Tabla `efectivos`
2. ‚ûï Tabla `historial_estados`
3. ‚ûï Tabla `tarea_efectivos`
4. ‚ûï Documentaci√≥n del Bot de Telegram (comandos, flujos)
5. ‚ûï Endpoints WebSocket
6. ‚ûï Configuraci√≥n de Redis
7. ‚ûï Health checks y m√©tricas Prometheus

---

**Documento generado:** 2025-10-12  
**Pr√≥ximo paso sugerido:** Crear nuevo manual desde cero bas√°ndose en estas correcciones
